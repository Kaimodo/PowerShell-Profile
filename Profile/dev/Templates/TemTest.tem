## content of .\Temtest.tem ##
<#PSScriptInfo
.VERSION %%ModuleVersion%%
.AUTHOR %%ModuleAuthor%%
.PROJECTURI %%ModuleWebsite%%
.DESCRIPTION
    Default Script Template
#>

using namespace System.Management.Automation.Host
#https://www.sharepointdiary.com/2021/11/progress-bar-in-powershell.html

function %%FunctionName%% {
		
	[CmdletBinding()]
	Param(
		[string]$logFileFolderPath = $PSScriptRoot + "./Profile/log",
		[string]$logFilePrefix = "my_ps_script_",
		[string]$logFileDateFormat = "yyyyMMdd_HHmmss",
		[int]$logFileRetentionDays = 30
	)

	begin {
		$FunctionName = $MyInvocation.MyCommand.Name
		Write-Verbose "$($FunctionName): Begin."
		$TempErrAct = $ErrorActionPreference
		$ErrorActionPreference = "Stop"
			
	}
	process {
		try {
			Write-Verbose "$($FunctionName):Process"
			#TODO: Start here
		}
		catch [Exception] {
			Write-Verbose "$($FunctionName): Process.catch"
			Write-Host "Error on line $($_.InvocationInfo.ScriptLineNumber): $($_.Exception.Message)"
			Write-Output $_.Exception|format-list -force
		}
	}

	end {
			Write-Verbose "$($FunctionName): End."
			$ErrorActionPreference = $TempErrAct
			if ($logFileFolderPath -ne "") { Stop-Transcript }
		}
}